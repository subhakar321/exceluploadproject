//@ui5-bundle exceluploadproject/Component-preload.js
sap.ui.predefine("exceluploadproject/Component", ["sap/ui/core/UIComponent","exceluploadproject/model/models"],(e,t)=>{"use strict";return e.extend("exceluploadproject.Component",{metadata:{manifest:"json",interfaces:["sap.ui.core.IAsyncContentCreation"]},init(){e.prototype.init.apply(this,arguments);this.setModel(t.createDeviceModel(),"device");this.getRouter().initialize()}})});
sap.ui.predefine("exceluploadproject/controller/App.controller", ["sap/ui/core/mvc/Controller"],e=>{"use strict";return e.extend("exceluploadproject.controller.App",{onInit(){}})});
sap.ui.predefine("exceluploadproject/controller/Log.controller", ["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel"],(e,t)=>{"use strict";return e.extend("exceluploadproject.controller.Log",{onInit(){var e=new t({fromDate:null,toDate:null,selectedUser:"",selectedStatus:""});this.getView().setModel(e,"filterModel");var r=new t;this.getView().setModel(r,"logModel");this.onReadLog()},onReadLog:function(){var e=this.getOwnerComponent().getModel();e.read("/fileLog",{success:function(e){this.getView().getModel("logModel").setProperty("/fileLog",e.results)}.bind(this),error:function(e){sap.m.MessageToast.show(e.message);console.error("Error details:",e)}})},onPressExecute:function(){var e=this.getView();var t=e.getModel("filterModel");var r=this.getOwnerComponent().getModel();var o=t.getProperty("/fromDate");var l=t.getProperty("/toDate");var s=t.getProperty("/selectedStatus");var i=t.getProperty("/selectedUser");function a(e){if(!e)return null;const[t,r,o]=e.split("-").map(Number);return`${o}-${String(r).padStart(2,"0")}-${String(t).padStart(2,"0")}`}var n=a(o);var d=a(l);var u=[];if(n&&d){u.push(new sap.ui.model.Filter({path:"logtime",operator:sap.ui.model.FilterOperator.BT,value1:n,value2:d}))}else if(n){u.push(new sap.ui.model.Filter("logtime",sap.ui.model.FilterOperator.GE,n))}else if(d){u.push(new sap.ui.model.Filter("logtime",sap.ui.model.FilterOperator.LE,d))}if(s){u.push(new sap.ui.model.Filter("status",sap.ui.model.FilterOperator.EQ,s))}if(i){u.push(new sap.ui.model.Filter("user",sap.ui.model.FilterOperator.EQ,i))}var p=u.length>=1?new sap.ui.model.Filter({filters:u,and:true}):u[0]||[];r.read("/fileLog",{filters:u.length?[p]:[],success:function(t){e.getModel("logModel").setProperty("/fileLog",t.results);sap.m.MessageToast.show("Filtered data loaded successfully!");console.log("Filtered Data:",t.results)},error:function(e){console.error("Error while fetching filtered data:",e);sap.m.MessageToast.show("Error fetching filtered data")}})}})});
sap.ui.predefine("exceluploadproject/controller/uploadView.controller", ["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/m/MessageToast","sap/m/ColumnListItem","sap/m/Input","sap/base/util/deepExtend","sap/m/CheckBox"],function(e,t,o,s,a,i,r){"use strict";return e.extend("exceluploadproject.controller.uploadView",{onInit:function(){this._bEditMode=false;var e=new t({bEditMode:false,editButtonText:"Edit"});if(typeof XLSX==="undefined"){sap.ui.require(["sap/ui/thirdparty/jquery"],function(){$.getScript("https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js")})}this.getView().setModel(e,"view");this.getView().setModel(new t({excelRows:[]}),"TableModel");var o=new t;this.getView().setModel(o,"csvModel");this.onReadCSV();this.oTable=this.byId("idCSVTable");this.oReadOnlyTemplate=this.byId("idCSVTable").getBindingInfo("items").template.clone();this.rebindTable(this.oReadOnlyTemplate,"Navigation");this.oEditableTemplate=new s({cells:[new a({value:"{csvModel>id}"}),new a({value:"{csvModel>name}",editable:"{= ${csvModel>selected} }"}),new a({value:"{csvModel>place}",editable:"{= ${csvModel>selected} }"}),new r({selected:"{csvModel>selected}"})]})},userinfo:function(){},onReadCSV:function(){var e=this.getOwnerComponent().getModel();e.read("/CsvRows",{success:function(e){this.getView().getModel("csvModel").setProperty("/csvRows",e.results)}.bind(this),error:function(e){sap.m.MessageToast.show(e.message);console.error("Error details:",e)}})},onExcelUpload:async function(e){var t=e.getParameter("files")[0];if(!t){o.show("Please choose an Excel file.");return}if(typeof XLSX==="undefined"){await new Promise((e,t)=>{$.getScript("https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js").done(e).fail(()=>t("Failed to load XLSX library"))})}var s=new FileReader;s.onload=function(e){var o=new Uint8Array(e.target.result);var s=XLSX.read(o,{type:"array"});var a=s.Sheets[s.SheetNames[0]];var i=XLSX.utils.sheet_to_json(a);var r=i.map(e=>Object.fromEntries(Object.entries(e).map(([e,t])=>[e.toLowerCase(),t])));var l=r.map(e=>Object.fromEntries(Object.entries(e).map(([e,t])=>[e.replace(/\s+/g,""),t])));var n=new Date;var d=n.toLocaleDateString();var c=n.toLocaleTimeString();var u=n.toISOString();l.forEach(e=>{e.uploadDate=d;e.uploadTime=c;e.uploadlogtime=u;e.fileName=t.name});var p=this.getView().getModel("TableModel");p.setProperty("/excelRows",l);p.setProperty("/uploadInfo",{fileName:t.name,fileSize:(t.size/1024).toFixed(2)+" KB",uploadedAt:u,recordCount:l.length});sap.m.MessageToast.show("Excel loaded successfully at "+c)}.bind(this);s.readAsArrayBuffer(t)},onSaveToHana:async function(){var e=this.byId("excelUploader");var t=e.oFileUpload?e.oFileUpload.files[0]:null;if(!t){sap.m.MessageToast.show("Please select a file before saving.");return}var o=this.getOwnerComponent().getModel();var s=this.getView().getModel("TableModel").getProperty("/excelRows");var a=this.getView().getModel("TableModel").getProperty("/uploadInfo/fileName");var i="subhakar";var r="Success";var l=(new Date).toISOString();var n="";var d=s.some(e=>!e.name||!e.place||e.name.trim()===""||e.place.trim()==="");if(d){r="Failure";n="Missing Name or Place in one or more rows. Upload cancelled.";sap.m.MessageToast.show("Upload failed: "+n);const e={filename:a,user:i,status:r,logtime:l.split("T")[0]};await new Promise((t,s)=>{o.create("/fileLog",e,{success:function(){t();o.refresh()},error:s})});this.getOwnerComponent().getRouter().navTo("Log");return}try{await new Promise((e,t)=>{o.callFunction("/uploadExcelData",{method:"GET",urlParameters:{data:JSON.stringify(s),fileName:a,user:i,status:r,logtime:l.split("T")[0]},success:function(t){console.log("Function success:",t);sap.m.MessageToast.show("Excel data uploaded successfully!");e();o.refresh()},error:function(e){console.error("Function error:",e);sap.m.MessageToast.show("Error uploading Excel data!");r="Failure";t(e)}})});const e={filename:a,user:i,status:r,logtime:l.split("T")[0]};this.getOwnerComponent().getRouter().navTo("Log")}catch(e){console.error("Upload Exception:",e);sap.m.MessageToast.show("Unexpected error during upload.")}},rebindTable:function(e,t){this.oTable.bindItems({path:"csvModel>/csvRows",template:e,templateShareable:true,key:"csvModel>id"}).setKeyboardMode(t)},onEdit:function(){var e=this.getView().getModel("view");var t=this.getView().getModel("csvModel");var s=t.getProperty("/csvRows");this._bEditMode=!this._bEditMode;e.setProperty("/bEditMode",this._bEditMode);e.setProperty("/editButtonText",this._bEditMode?"Cancel Edit":"Edit");if(this._bEditMode){s.forEach(function(e){e.selected=e.name==="Ravi111"});o.show("Edit mode enabled")}else{s.forEach(function(e){e.selected=false});o.show("View mode enabled")}t.setProperty("/csvRows",s);this.aProductCollection=i([],this.getView().getModel("csvModel").getProperty("/csvRows"));this.rebindTable(this.oEditableTemplate,"Edit")},onCancel:function(){var e=this.getView().getModel("csvModel").getProperty("/csvRows");this.getView().getModel("csvModel").setProperty("/csvRows",e);this.rebindTable(this.oReadOnlyTemplate,"Navigation")},onSave:function(){var e=this.getOwnerComponent().getModel();var t=this.getView().getModel("csvModel").getProperty("/csvRows");t.forEach(function(t){var o="/CsvRows("+t.id+")";var s={name:t.name,place:t.place};e.update(o,s,{success:function(){console.log("Record "+t.id+" updated successfully")},error:function(e){console.error("Error updating record "+t.id,e);sap.m.MessageToast.show("Update failed for record "+t.id)}})});this.onReadCSV();sap.m.MessageToast.show("All records updated successfully!");this.rebindTable(this.oReadOnlyTemplate,"Navigation")}})});
sap.ui.predefine("exceluploadproject/model/models", ["sap/ui/model/json/JSONModel","sap/ui/Device"],function(e,n){"use strict";return{createDeviceModel:function(){var i=new e(n);i.setDefaultBindingMode("OneWay");return i}}});
sap.ui.require.preload({
	"exceluploadproject/i18n/i18n.properties":'# This is the resource bundle for exceluploadproject\n\n#Texts for manifest.json\n\n#XTIT: Application name\nappTitle=Excel Upload\n\n#YDES: Application description\nappDescription=An SAP Fiori application.\n#XTIT: Main view title\ntitle=Excel Upload\nplaceHolder= Select File\nexcelFile = Invoice Excle File : \nuploadLogstitle= Upload Logs Screen\nfromDate= From : \nToDate = To :\nlogTableTitle= Invoice Excel Upload Logs\nfileName= File Name\nstatus= Status\ntimestamp= TimeStamp\nexecuteBtn= Execute\nerrorBtn = Errors\nupdateBtn = Update PO\ncreateteBtn = Create IBD\nInvPo = Invoice PO Match\nfilterStatus = Staus :\nfilterUser = User :',
	"exceluploadproject/manifest.json":'{"_version":"1.76.0","sap.app":{"id":"exceluploadproject","type":"application","i18n":{"bundleUrl":"i18n/i18n.properties","supportedLocales":[""]},"applicationVersion":{"version":"0.0.1"},"title":"{{appTitle}}","description":"{{appDescription}}","resources":"resources.json","sourceTemplate":{"id":"@sap/generator-fiori:basic","version":"1.19.3","toolsId":"1df2e5af-3475-4698-9090-02c2d5d38a04"},"dataSources":{"mainService":{"uri":"/odata/v2/catalog/","type":"OData","settings":{"annotations":[],"localUri":"localService/mainService/metadata.xml","odataVersion":"2.0"}}}},"sap.ui":{"technology":"UI5","icons":{"icon":"","favIcon":"","phone":"","phone@2":"","tablet":"","tablet@2":""},"deviceTypes":{"desktop":true,"tablet":true,"phone":true}},"sap.ui5":{"flexEnabled":true,"dependencies":{"minUI5Version":"1.142.0","libs":{"sap.m":{},"sap.ui.core":{}}},"contentDensities":{"compact":true,"cozy":true},"models":{"i18n":{"type":"sap.ui.model.resource.ResourceModel","settings":{"bundleName":"exceluploadproject.i18n.i18n","supportedLocales":[""]}},"":{"dataSource":"mainService","preload":true,"settings":{}}},"resources":{"css":[{"uri":"css/style.css"}]},"routing":{"config":{"routerClass":"sap.m.routing.Router","controlAggregation":"pages","controlId":"app","transition":"slide","type":"View","viewType":"XML","path":"exceluploadproject.view","async":true,"viewPath":"exceluploadproject.view"},"routes":[{"name":"RouteuploadView","pattern":"","target":["TargetuploadView"]},{"name":"Log","pattern":"Log","target":["LogTarget"]}],"targets":{"TargetuploadView":{"id":"uploadView","name":"uploadView"},"LogTarget":{"id":"Log","name":"Log"}}},"rootView":{"viewName":"exceluploadproject.view.App","type":"XML","id":"App","async":true},"flexBundle":false},"sap.cloud":{"public":true,"service":"exceluploadproject"}}',
	"exceluploadproject/view/App.view.xml":'<mvc:View controllerName="exceluploadproject.controller.App"\n    displayBlock="true"\n    xmlns:mvc="sap.ui.core.mvc"\n    xmlns="sap.m"><App id="app"></App></mvc:View>',
	"exceluploadproject/view/Log.view.xml":'<mvc:View controllerName="exceluploadproject.controller.Log"\n    displayBlock="true"\n     xmlns:core="sap.ui.core"\n    xmlns:mvc="sap.ui.core.mvc"\n    xmlns:l="sap.ui.layout"\n    xmlns:u="sap.ui.unified"\n    xmlns="sap.m"><Page><content><l:FixFlex minFlexSize="400"><l:fixContent><VBox><Title\n                            text="{i18n>logTableTitle}"\n                            titleStyle="H4"\n                            class="sapUiTinyMarginBegin sapUiTinyMarginTop"\n                        /><HBox\n                            alignItems="Center"\n                            alignContent="Center"\n                            justifyContent="Center"\n                            width="100%"\n                        ><HBox><Label\n                                    id="_IDfrom"\n                                    design="Bold"\n                                    text="{i18n>fromDate}"\n                                    class="sapUiTinyMarginTop sapUiTinyMarginBegin"\n                                /><DatePicker\n                                    id="idFromDate"\n                                    width="10rem"\n                                    valueFormat="dd-MM-yyyy"\n                                    displayFormat="dd-MM-yyyy"\n                                    change=".onDateChange"\n                                   value="{filterModel>/fromDate}"\n                                /></HBox><HBox><Label\n                                    id="_IDto"\n                                    design="Bold"\n                                    text="{i18n>ToDate}"\n                                    class="sapUiTinyMarginTop sapUiTinyMarginBegin"\n                                /><DatePicker\n                                    id="idToDate"\n                                    width="10rem"\n                                    valueFormat="dd-MM-yyyy"\n                                    displayFormat="dd-MM-yyyy"\n                                    change=".onDateChange"\n                                   value="{filterModel>/toDate}"\n                                /><Label\n                                    id="_IDUser"\n                                    design="Bold"\n                                    text="{i18n>filterUser}"\n                                    class="sapUiTinyMarginTop sapUiTinyMarginBegin"\n                                /><ComboBox selectedKey="{filterModel>/selectedUser}"\n                                    items="{logModel>/fileLog}"\n                                ><core:Item\n                                        key="{logModel>user}"\n                                        text="{logModel>user}"\n                                    /></ComboBox><Label\n                                    id="_IDStatus"\n                                    design="Bold"\n                                    text="{i18n>filterStatus}"\n                                    class="sapUiTinyMarginTop sapUiTinyMarginBegin"\n                                /><ComboBox\n                                    items="{logModel>/fileLog}" selectedKey="{filterModel>/selectedStatus}"\n                                ><core:Item\n                                        key="{logModel>status}"\n                                        text="{logModel>status}"\n                                    /></ComboBox><Button\n                                    type="Emphasized"\n                                    text="{i18n>executeBtn}"\n                                    press="onPressExecute"\n                                    class="sapUiTinyMarginBegin"\n                                /></HBox></HBox><FlexBox\n                            id="fbMContItemDetails"\n                            justifyContent="SpaceAround"\n                            class="tileContainer whiteBg bottomSubTile sapUiTinyMargin custToggleAnimation"\n                            width="98.5%"\n                        ><VBox><HBox><core:Icon\n                                        src="sap-icon://color-fill"\n                                        class="iconPosition sapUiTinyMarginTop"\n                                        color="#A95DF1"\n                                    /><Label\n                                        id="_IDTableTitle"\n                                        design="Bold"\n                                        text="{i18n>logTableTitle}"\n                                        class="RevenueValueTitle sapUiSmallMarginBegin sapUiTinyMarginTop tileSubContentHeading"\n                                    /></HBox><Table\n                                    class="sapUiLargeMarginEnd"\n                                    width="98%"\n                                    id="idLogsTable"\n                                    backgroundDesign="Transparent"\n                                    items="{logModel>/fileLog}"\n\t\t\t                      \n\t\t\t\n\t\t                            \n                                ><columns><Column width="12em"><Text\n                                                text="{i18n>fileName}"\n                                                class="whiteFont"\n                                            /></Column><Column><Text\n                                                text="{i18n>timestamp}"\n                                                class="whiteFont"\n                                            /></Column><Column><Text\n                                                text="{i18n>status}"\n                                                class="whiteFont"\n                                            /></Column></columns><items><ColumnListItem vAlign="Middle" type="Navigation" press=".onItemPress"><cells><Text text="{logModel>filename}" /><Text\n                                                    text="{logModel>logtime}"\n                                                /><Text\n                                                    text="{logModel>status}"\n                                                /></cells></ColumnListItem></items></Table></VBox></FlexBox></VBox></l:fixContent></l:FixFlex ></content></Page></mvc:View>',
	"exceluploadproject/view/uploadView.view.xml":'<mvc:View controllerName="exceluploadproject.controller.uploadView"\n    \txmlns:core="sap.ui.core"\n\txmlns:mvc="sap.ui.core.mvc"\n    \txmlns:l="sap.ui.layout"\n\txmlns:u="sap.ui.unified"\n    xmlns="sap.m"><Page id="page" title="{i18n>title}"><content><u:FileUploader\n\t\t\tid="excelUploader"\n                name="excelFile"\n                fileType="xlsx"\n                change="onExcelUpload"/><Button id="_IDGenButton" text="Save to HANA" press="onSaveToHana"/><Table\n                id="idCSVTable"\n                growing="true"\n                growingThreshold="10"\n                paste="onPaste"\n                items="{csvModel>/csvRows}"><headerToolbar><OverflowToolbar id="otbSubheader"><Title id="_IDGenTitle"\n                            text="CSV-DATA"\n                            level="H2"\n                        /><ToolbarSpacer id="_IDGenToolbarSpacer1" /><Button\n                            id="editButton"\n                            text="Edit"\n                            type="Transparent"\n                            press="onEdit"\n                        /><Button\n                            id="saveButton"\n                            text="Save"\n                            type="Transparent"\n                            press="onSave"\n                           \n                        /><Button\n                            id="cancelButton"\n                            text="Cancel"\n                            type="Transparent"\n                            press="onCancel"\n                           \n                        /></OverflowToolbar></headerToolbar><columns><Column id="_IDGenColumn" width="12em"><Text id="_IDGenText" text="ID" /></Column><Column id="_IDGenColumn1"><Text id="_IDGenText6" text="NAME" /></Column><Column id="_IDGenColumn2"><Text id="_IDGenText7" text="PLACE" /></Column><Column id="_IDGenColumn3"><Text  text="Select" /></Column></columns><items><ColumnListItem id="_IDGenColumnListItem" vAlign="Middle" ><cells><Text id="_IDGenText8" text="{csvModel>id}" /><Text id="_IDGenText9" text="{csvModel>name}" /><Text id="_IDGenText10" text="{csvModel>place}" /><CheckBox id="idCheckBox" selected="{csvModel>selected}" enabled="{= ${view>/bEditMode} }"/></cells></ColumnListItem></items></Table></content></Page></mvc:View>'
});
//# sourceMappingURL=Component-preload.js.map

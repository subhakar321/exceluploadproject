//@ui5-bundle exceluploadproject/Component-preload.js
sap.ui.predefine("exceluploadproject/Component", ["sap/ui/core/UIComponent","exceluploadproject/model/models"],(e,t)=>{"use strict";return e.extend("exceluploadproject.Component",{metadata:{manifest:"json",interfaces:["sap.ui.core.IAsyncContentCreation"]},init(){e.prototype.init.apply(this,arguments);this.setModel(t.createDeviceModel(),"device");this.getRouter().initialize()}})});
sap.ui.predefine("exceluploadproject/controller/App.controller", ["sap/ui/core/mvc/Controller"],e=>{"use strict";return e.extend("exceluploadproject.controller.App",{onInit(){}})});
sap.ui.predefine("exceluploadproject/controller/uploadView.controller", ["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/m/MessageToast","sap/m/ColumnListItem","sap/m/Input","sap/base/util/deepExtend","sap/m/CheckBox"],function(e,t,o,s,a,i,l){"use strict";return e.extend("exceluploadproject.controller.uploadView",{onInit:function(){this._bEditMode=false;var e=new t({bEditMode:false,editButtonText:"Edit"});this.getView().setModel(e,"view");this.getView().setModel(new t({excelRows:[]}),"TableModel");var o=new t;this.getView().setModel(o,"csvModel");this.onReadCSV();this.oTable=this.byId("idCSVTable");this.oReadOnlyTemplate=this.byId("idCSVTable").getBindingInfo("items").template.clone();this.rebindTable(this.oReadOnlyTemplate,"Navigation");this.oEditableTemplate=new s({cells:[new a({value:"{csvModel>id}"}),new a({value:"{csvModel>name}",editable:"{= ${csvModel>selected} }"}),new a({value:"{csvModel>place}",editable:"{= ${csvModel>selected} }"}),new l({selected:"{csvModel>selected}"})]})},onReadCSV:function(){var e=this.getOwnerComponent().getModel();e.read("/CsvRows",{success:function(e){this.getView().getModel("csvModel").setProperty("/csvRows",e.results)}.bind(this),error:function(e){sap.m.MessageToast.show(e.message);console.error("Error details:",e)}})},onExcelUpload:function(e){var t=e.getParameter("files")[0];if(!t){o.show("Please choose an Excel file.");return}var s=new FileReader;s.onload=function(e){var t=new Uint8Array(e.target.result);var s=XLSX.read(t,{type:"array"});var a=s.Sheets[s.SheetNames[0]];var i=XLSX.utils.sheet_to_json(a);var l=i.map(e=>Object.fromEntries(Object.entries(e).map(([e,t])=>[e.toLowerCase(),t])));var r=l.map(e=>Object.fromEntries(Object.entries(e).map(([e,t])=>[e.replace(/\s+/g,""),t])));this.getView().getModel("TableModel").setProperty("/excelRows",r);o.show("Excel loaded successfully!")}.bind(this);s.readAsArrayBuffer(t)},onSaveToHana:function(){var e=this.getOwnerComponent().getModel();var t=this.getView().getModel("TableModel").getProperty("/excelRows");t.forEach(function(t){var o={name:t.name,place:t.place};e.create("/CsvRows",o,{success:function(){console.log("Created:",o)},error:function(e){console.error("Error creating record:",e)}})});o.show("Data sent to backend!")},rebindTable:function(e,t){this.oTable.bindItems({path:"csvModel>/csvRows",template:e,templateShareable:true,key:"csvModel>id"}).setKeyboardMode(t)},onEdit:function(){var e=this.getView().getModel("view");var t=this.getView().getModel("csvModel");var s=t.getProperty("/csvRows");this._bEditMode=!this._bEditMode;e.setProperty("/bEditMode",this._bEditMode);e.setProperty("/editButtonText",this._bEditMode?"Cancel Edit":"Edit");if(this._bEditMode){s.forEach(function(e){e.selected=e.name==="Ravi111"});o.show("Edit mode enabled")}else{s.forEach(function(e){e.selected=false});o.show("View mode enabled")}t.setProperty("/csvRows",s);this.aProductCollection=i([],this.getView().getModel("csvModel").getProperty("/csvRows"));this.rebindTable(this.oEditableTemplate,"Edit")},onCancel:function(){var e=this.getView().getModel("csvModel").getProperty("/csvRows");this.getView().getModel("csvModel").setProperty("/csvRows",e);this.rebindTable(this.oReadOnlyTemplate,"Navigation")},onSave:function(){var e=this.getOwnerComponent().getModel();var t=this.getView().getModel("csvModel").getProperty("/csvRows");t.forEach(function(t){var o="/CsvRows("+t.id+")";var s={name:t.name,place:t.place};e.update(o,s,{success:function(){console.log("Record "+t.id+" updated successfully")},error:function(e){console.error("Error updating record "+t.id,e);sap.m.MessageToast.show("Update failed for record "+t.id)}})});this.onReadCSV();sap.m.MessageToast.show("All records updated successfully!");this.rebindTable(this.oReadOnlyTemplate,"Navigation")}})});
sap.ui.predefine("exceluploadproject/model/models", ["sap/ui/model/json/JSONModel","sap/ui/Device"],function(e,n){"use strict";return{createDeviceModel:function(){var i=new e(n);i.setDefaultBindingMode("OneWay");return i}}});
sap.ui.require.preload({
	"exceluploadproject/i18n/i18n.properties":'# This is the resource bundle for exceluploadproject\n\n#Texts for manifest.json\n\n#XTIT: Application name\nappTitle=Excel Upload\n\n#YDES: Application description\nappDescription=An SAP Fiori application.\n#XTIT: Main view title\ntitle=Excel Upload',
	"exceluploadproject/manifest.json":'{"_version":"1.76.0","sap.app":{"id":"exceluploadproject","type":"application","i18n":{"bundleUrl":"i18n/i18n.properties","supportedLocales":[""]},"applicationVersion":{"version":"0.0.1"},"title":"{{appTitle}}","description":"{{appDescription}}","resources":"resources.json","sourceTemplate":{"id":"@sap/generator-fiori:basic","version":"1.19.3","toolsId":"1df2e5af-3475-4698-9090-02c2d5d38a04"},"dataSources":{"mainService":{"uri":"/odata/v2/catalog/","type":"OData","settings":{"annotations":[],"localUri":"localService/mainService/metadata.xml","odataVersion":"2.0"}}}},"sap.ui":{"technology":"UI5","icons":{"icon":"","favIcon":"","phone":"","phone@2":"","tablet":"","tablet@2":""},"deviceTypes":{"desktop":true,"tablet":true,"phone":true}},"sap.ui5":{"flexEnabled":true,"dependencies":{"minUI5Version":"1.142.0","libs":{"sap.m":{},"sap.ui.core":{}}},"contentDensities":{"compact":true,"cozy":true},"models":{"i18n":{"type":"sap.ui.model.resource.ResourceModel","settings":{"bundleName":"exceluploadproject.i18n.i18n","supportedLocales":[""]}},"":{"dataSource":"mainService","preload":true,"settings":{}}},"resources":{"css":[{"uri":"css/style.css"}]},"routing":{"config":{"routerClass":"sap.m.routing.Router","controlAggregation":"pages","controlId":"app","transition":"slide","type":"View","viewType":"XML","path":"exceluploadproject.view","async":true,"viewPath":"exceluploadproject.view"},"routes":[{"name":"RouteuploadView","pattern":":?query:","target":["TargetuploadView"]}],"targets":{"TargetuploadView":{"id":"uploadView","name":"uploadView"}}},"rootView":{"viewName":"exceluploadproject.view.App","type":"XML","id":"App","async":true},"flexBundle":false},"sap.cloud":{"public":true,"service":"exceluploadproject"}}',
	"exceluploadproject/view/App.view.xml":'<mvc:View controllerName="exceluploadproject.controller.App"\n    displayBlock="true"\n    xmlns:mvc="sap.ui.core.mvc"\n    xmlns="sap.m"><App id="app"></App></mvc:View>',
	"exceluploadproject/view/uploadView.view.xml":'<mvc:View controllerName="exceluploadproject.controller.uploadView"\n    \txmlns:core="sap.ui.core"\n\txmlns:mvc="sap.ui.core.mvc"\n    \txmlns:l="sap.ui.layout"\n\txmlns:u="sap.ui.unified"\n    xmlns="sap.m"><Page id="page" title="{i18n>title}"><content><u:FileUploader\n\t\t\tid="excelUploader"\n                name="excelFile"\n                fileType="xlsx"\n                change="onExcelUpload"/><Button id="_IDGenButton" text="Save to HANA" press="onSaveToHana"/><Table\n                id="idCSVTable"\n                growing="true"\n                growingThreshold="10"\n                paste="onPaste"\n                items="{csvModel>/csvRows}"><headerToolbar><OverflowToolbar id="otbSubheader"><Title id="_IDGenTitle"\n                            text="CSV-DATA"\n                            level="H2"\n                        /><ToolbarSpacer id="_IDGenToolbarSpacer1" /><Button\n                            id="editButton"\n                            text="Edit"\n                            type="Transparent"\n                            press="onEdit"\n                        /><Button\n                            id="saveButton"\n                            text="Save"\n                            type="Transparent"\n                            press="onSave"\n                           \n                        /><Button\n                            id="cancelButton"\n                            text="Cancel"\n                            type="Transparent"\n                            press="onCancel"\n                           \n                        /></OverflowToolbar></headerToolbar><columns><Column id="_IDGenColumn" width="12em"><Text id="_IDGenText" text="ID" /></Column><Column id="_IDGenColumn1"><Text id="_IDGenText6" text="NAME" /></Column><Column id="_IDGenColumn2"><Text id="_IDGenText7" text="PLACE" /></Column><Column id="_IDGenColumn3"><Text  text="Select" /></Column></columns><items><ColumnListItem id="_IDGenColumnListItem" vAlign="Middle" ><cells><Text id="_IDGenText8" text="{csvModel>id}" /><Text id="_IDGenText9" text="{csvModel>name}" /><Text id="_IDGenText10" text="{csvModel>place}" /><CheckBox id="idCheckBox" selected="{csvModel>selected}" enabled="{= ${view>/bEditMode} }"/></cells></ColumnListItem></items></Table></content></Page></mvc:View>'
});
//# sourceMappingURL=Component-preload.js.map
